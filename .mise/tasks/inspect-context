#!/usr/bin/env bash
#MISE description="Inspect the context being sent to Claude"
#MISE usage="inspect-context <message>"

set -e

MESSAGE="${1:-Say hello}"

cd "$(git rev-parse --show-toplevel)/cli"
mix escript.build >/dev/null 2>&1

./cli --log-context "$MESSAGE"

# Find the most recent log file
LOG_FILE=$(ls -t /tmp/claude-context-*.log 2>/dev/null | head -1)

if [ -n "$LOG_FILE" ]; then
  echo ""
  echo "=== Context Log ==="
  cat "$LOG_FILE"
fi
