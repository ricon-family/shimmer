#!/usr/bin/env bash
#MISE description="Watch the latest workflow run until completion"
#MISE usage="watch [agent]"

set -e

AGENT="${1:-quick}"

# Map agent names to workflow files
case "$AGENT" in
  quick)
    WORKFLOW="quick.yml"
    ;;
  brownie)
    WORKFLOW="brownie.yml"
    ;;
  junior)
    WORKFLOW="junior.yml"
    ;;
  *)
    echo "Unknown agent: $AGENT"
    echo "Available agents: quick, brownie, junior"
    exit 1
    ;;
esac

RUN_ID=$(gh run list --workflow="$WORKFLOW" --limit 1 --json databaseId -q '.[0].databaseId')
gh run watch "$RUN_ID"
